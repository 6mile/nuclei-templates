id: appian-detect

info:
  name: Appian quick detect
  author: 6mile
  severity: info
  metadata:
    verified: true
    max-request: 1
    shodan-query: __appiancsrftoken:
    shodan-query: set-cookie: __appianCsrfToken=
  tags: tech,zope

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: or
    matchers:

      - type: word
        part: header
        words:
          - "-cookie: __appianCsrfToken:"
	case-insensitive: true

      - type: word
        part: header
        words:
          - "set-cookie: __appianCsrfToken="
	case-insensitive: true

      - type: word
        part: header
        words:
          - "X-Appian-Redirect:"
	case-insensitive: true

      - type: word
        part: header
        words:
          - "Server: Appian Webapp HTTP"
	case-insensitive: true

      - type: word
        part: header
        words:
          - "Content-Security-Policy-Report-Only: report-to /suite/rest/a/logging/latest/csp/report;"
	case-insensitive: true
